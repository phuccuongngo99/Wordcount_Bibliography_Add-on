<!DOCTYPE html>
<link href="https://ssl.gstatic.com/docs/script/css/add-ons.css"
     rel="stylesheet"> 
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <div>
      <button class="blue" type='reset' id='check_count' onclick='checkCount()'>Check Wordcount</button>
    </div>
    <div>
      <form name="listForm" class="form-inline">
      Total Word-count: <input type="text" size="3" name="total" value="0"/>
      </form>
    </div>
    <div id='display_count'></div>
    <div id='partCount'></div>
  </body>
</html>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js">
</script>

<script>
function checkTotal() {
  document.listForm.total.value = '';
  var sum = 0;
  for (var i=0;i<document.listForm.choice.length;i++) {
    if (document.listForm.choice[i].checked) {
	  sum += parseInt(document.listForm.choice[i].value);
	}
  }
  document.listForm.total.value = sum;
}

function checkCount(){
  document.getElementById('partCount').innerHTML = '';
  google.script.run.withSuccessHandler(display).main();
  function display(paraList){
    document.listForm.innerHTML = "Total Word-count: <input type='text' size='1' name='total' value='0'/>"
    var totalNum = 0;
    paraList.forEach(function(paraObj){
      var heading = Object.keys(paraObj)[0];
      var num = paraObj[heading];
      totalNum += num;
      // creating new checkbox
      var newp = document.createElement('p')
      newp.innerHTML = "<input type='checkbox' name='choice' value="+String(num)+" onchange='checkTotal()' checked/>"+heading+" ("+String(num)+") "+"<br/>"
      document.listForm.appendChild(newp)
    })
    document.listForm.total.value = totalNum;
  }
};
</script>
